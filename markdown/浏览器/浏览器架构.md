# 浏览器架构

## 单进程浏览器时代

![avatar](https://user-gold-cdn.xitu.io/2020/7/4/1731a06606fcea9d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

单进程浏览器是指浏览器所有模块都运行在同一个进程里，这些模块包含了网络、插件、js运行环境、渲染引擎和页面等。

不稳定，不流畅，不安全。

## 多进程浏览器时代

![avatar](https://user-gold-cdn.xitu.io/2020/7/4/1731a069d7f27b6a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

**解决不稳定：** 由于进程是互相隔离的，所以当一个页面或者插件崩溃时仅仅想象的时当前的页面进程或者插件进程，并不会影响到别的。

**解决不流畅：**  JavaScript运行在渲染进程中，所以即使js阻塞了渲染进程，影响到的也只是当前的渲染页面，并不会影响浏览器和其他页面，因为其他页面的脚本时运行在他们自己的渲染进程中的。
同时，关闭一个页面时，整个渲染进程也会关闭，之后该进程所占用的内存都会被系统回收，这样就轻松解决了浏览器页面内存泄漏问题。

**解决安全问题：** 使用安全沙箱，沙箱里的程序可以运行，但是不允许在硬盘上写入任何数据。

## 目前多进程架构

![avatar](https://user-gold-cdn.xitu.io/2020/7/4/1731a0e8b5d3ce19?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

* 浏览器进程。 主要负责界面显示、用户交互、子进程管理，同时提供存储功能。
* 渲染进程。 核心任务是将HTML、CSS和JavaScript转换为用户可以为之交互的网页，排版引擎Blink和JavaScript引擎V8都是运行在该进程中，默认情况下，Chrome会给每个tab创建一个渲染进程。但如果从一个页面打开了新页面，而且新页面和当前页面属于同一站点时，那么新页面会复用父页面的渲染进程。
* GPU进程。采用GPU绘制。
* 网络进程。 负责网络资源加载。
* 插件进程。 主要负责插件的运行。

*问题：更高的资源占用，耦合性搞，扩展性差*。

## 未来面向服务的架构（SOA）

![avatar](https://user-gold-cdn.xitu.io/2020/7/4/1731a0745f8b3616?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

